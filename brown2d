import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

#perameters

D = 1.0        # диффузия (разлет)
dt = 0.01      # шаг времени
n_steps = 1000 # сколько шагов моделируем

t = np.arange(n_steps + 1) * dt
sigma = np.sqrt(2 * D * dt)   # средний шаг


# моделируем 2d brown movement

x = np.zeros(n_steps + 1)
y = np.zeros(n_steps + 1)

for i in range(n_steps):
    x[i+1] = x[i] + sigma * np.random.randn()
    y[i+1] = y[i] + sigma * np.random.randn()


# анимация 2d

def animate_2d():
    fig, ax = plt.subplots()

    ax.set_title("2D Броуновское движение частицы")
    ax.set_xlabel("x")
    ax.set_ylabel("y")
    ax.set_aspect("equal", "box")

    R = np.sqrt(4 * D * t[-1]) * 3
    ax.set_xlim(-R, R)
    ax.set_ylim(-R, R)

    line, = ax.plot([], [], lw=2)

    def update(frame):
        line.set_data(x[:frame], y[:frame])
        return line,

    global ani # без нее картинка не будет рисоваться, для сохранения перемнной ani
    ani = FuncAnimation(fig, update, frames=n_steps, interval=10)

    plt.show()

animate_2d()
